<div class="response-container">
  <!-- Metrics Section -->
  <div class="metrics-section">
    <div class="metric-card score-card">
      <label>Overall Score</label>
      <p-knob
        [(ngModel)]="response[0].score"
        [min]="0"
        [max]="10"
        [readonly]="true"
        [size]="120"
        [strokeWidth]="8"
        valueColor="var(--color-primary)"
        rangeColor="var(--color-gray-200)"
      />
    </div>
    
    <div class="metric-card">
      <label>Modules Analyzed</label>
      <h1>{{ response[0].module_count }}</h1>
    </div>
  </div>

  <!-- Detailed Results Table -->
  <div class="table-section">
    <h4>
      <i class="pi pi-list" style="margin-right: 8px;"></i>
      Detailed Analysis Results
    </h4>
    
    <p-table
      [columns]="headers"
      [value]="response"
      [tableStyle]="{ 'min-width': '100%' }"
    >
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th *ngFor="let col of columns">
            {{ col | titlecase }}
          </th>
          <th style="width: 200px; text-align: center;">Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body">
        <tr>
          <td *ngFor="let col of headers">
            <span class="metric-value">{{ response[0].message_count[col] }}</span>
          </td>
          <td style="text-align: center; padding: var(--spacing-3);">
            <p-button
              (onClick)="getFullReport()"
              [disabled]="fetching"
              [class]="fetching ? 'download-button preparing' : 'download-button'"
            >
              <div *ngIf="!fetching" style="display: flex; align-items: center; gap: 6px;">
                <i class="pi pi-download"></i>
                <span>Download</span>
              </div>
              <div *ngIf="fetching" class="loading-button">
                Preparing...
              </div>
            </p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
